@if (storeId) {
  <div class="crm-header-actions" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding: 0 24px; margin-top: 24px;">
    
    <div class="segment-tabs" style="display: flex; gap: 6px; background: #f3f4f6; padding: 4px; border-radius: 12px; overflow-x: auto; max-width: 80%;">
      <button 
        (click)="filterBySegment('All')"
        [style.background]="activeSegment === 'All' ? 'white' : 'transparent'"
        [style.box-shadow]="activeSegment === 'All' ? '0 2px 4px rgba(0,0,0,0.1)' : 'none'"
        style="border: none; padding: 8px 14px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 13px; transition: 0.2s; white-space: nowrap;">
        All ({{getSegmentCount('All')}})
      </button>
      
      <button 
        (click)="filterBySegment('New')"
        [style.background]="activeSegment === 'New' ? '#e0f2fe' : 'transparent'"
        [style.box-shadow]="activeSegment === 'New' ? '0 2px 4px rgba(0,0,0,0.05)' : 'none'"
        style="border: none; padding: 8px 14px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 13px; color: #0369a1; white-space: nowrap;">
        ğŸ†• New ({{getSegmentCount('New')}})
      </button>

      <button 
        (click)="filterBySegment('VIP')"
        [style.background]="activeSegment === 'VIP' ? '#fef3c7' : 'transparent'"
        [style.box-shadow]="activeSegment === 'VIP' ? '0 2px 4px rgba(0,0,0,0.05)' : 'none'"
        style="border: none; padding: 8px 14px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 13px; color: #d97706; white-space: nowrap;">
        ğŸ’ VIP ({{getSegmentCount('VIP')}})
      </button>

      <button 
        (click)="filterBySegment('Frequent')"
        [style.background]="activeSegment === 'Frequent' ? '#dcfce7' : 'transparent'"
        [style.box-shadow]="activeSegment === 'Frequent' ? '0 2px 4px rgba(0,0,0,0.05)' : 'none'"
        style="border: none; padding: 8px 14px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 13px; color: #16a34a; white-space: nowrap;">
        ğŸ” Frequent ({{getSegmentCount('Frequent')}})
      </button>

      <button 
        (click)="filterBySegment('Dormant')"
        [style.background]="activeSegment === 'Dormant' ? '#fee2e2' : 'transparent'"
        [style.box-shadow]="activeSegment === 'Dormant' ? '0 2px 4px rgba(0,0,0,0.05)' : 'none'"
        style="border: none; padding: 8px 14px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 13px; color: #dc2626; white-space: nowrap;">
        ğŸ›‘ Dormant ({{getSegmentCount('Dormant')}})
      </button>
    </div>

    <button class="btn secondary" [routerLink]="['/', storeId, 'crm', 'loyalty-settings']" style="background: white; border: 1px solid #d1d5db; padding: 8px 16px; border-radius: 8px; font-weight: 600; cursor: pointer; white-space: nowrap;">
      âš™ï¸ Loyalty Rules
    </button>
  </div>

  <div>
    <app-dynamic-table
      [data]="filteredCustomers"
      [columns]="tableColumns"
      [filters]="customerFilters"
      [pageSize]="10"
      [hasActions]="false"
      [rowRouteBase]="'/' + storeId + '/crm/view'"
      [rowIdField]="'id'"
      [buttonLabel]="'Add Customer'"
      [buttonRoute]="'/' + storeId + '/crm/add'"
    ></app-dynamic-table>
  </div>
}